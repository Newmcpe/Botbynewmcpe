<?php
if (!isset($_REQUEST)) {
    return;
}
$confirmation_token = 'b2ac9619';
$token = '8f3c0adb4483895ef105b8e0a85d4b74ca8500af8b6a04bb238844d2180582e7add931ab4f8c7980d1da2';
$data = json_decode(file_get_contents('php://input'));
switch ($data->type) {
    case 'confirmation':
        echo $confirmation_token;
 //       echo('ok');—Ñ
        break;
    case 'wall_post_new':
        $dir = __DIR__ . "/subscribers.txt";
        $textpost = $data->object->text;
        $messagetosend = "–ù–æ–≤—ã–π –ø–æ—Å—Ç/–º–µ–º –≤ –≥—Ä—É–ø–ø–µ:\n–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞/–º–µ–º–∞: $textpost";

        $request_params = array(
            'message' => $messagetosend,
            'user_ids' => file_get_contents($dir),
            //'user_id' => '455064951',
            'access_token' => $token,
            'v' => '5.0'
        );
        $get_params = http_build_query($request_params);
        file_get_contents('https://api.vk.com/method/messages.send?' . $get_params);
        echo('ok');
        break;
    case 'message_new':
        $user_id = $data->object->user_id;
        $user_info = json_decode(file_get_contents("https://api.vk.com/method/users.get?user_ids={$user_id}&v=5.0"));
        $user_name = $user_info->response[0]->first_name;
        $user_name = $user_name . " " . $user_info->response[0]->last_name;
        $message = $data->object->body;
        if (stripos($message,"–ø—Ä–∏–≤–µ—Ç",0,"utf-8") !== false) {
            $newmessage = "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é,—Ç–æ–≤–∞—Ä–∏—â $user_name.\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\nüî¥ –ú–∏–ª–∞ üî¥ \n üî¥ –ê–Ω–∏–º–µ üî¥ \n üî¥ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ—É—Ç–±–æ–ª üî¥ \n üî¥ –º–µ–º üî¥ \n üî¥ –ò–ª—å—è –ø–∏–¥–æ—Ä üî¥ \n üî¥ –ö–∞—Ä—Ç–∏–Ω–∫–∞ üî¥ \n üî¥ –•–µ–Ω—Ç–∞–π üî¥ \n üî¥ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É üî¥ \n üî¥ –î–ª—è –≤–∞–∂–Ω—ã—Ö –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤ üî¥ \n üî¥ –û –±–æ—Ç–µ üî¥";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'access_token' => $token,
                'attachment' => 'photo-154749823_456239538',
                'v' => '5.0'
            );
        }
        if (mb_stripos($message,"–º–∏–ª–∞") !== false) {
            $newmessage = "–õ–æ—à–∞–¥—å";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'attachment' => "photo-154749823_456239554",
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if (mb_stripos( $message,"–∞–Ω–≥–µ–ª–∏–Ω–∞") !== false) {
            $newmessage = "–ù–∞–π–¥–µ–Ω–∞ –ø–æ—Ä–Ω—É—Ö–∞ —Å –ê–Ω–≥–µ–ª–∏–Ω–æ–π: \n–≠–¥—É–∞—Ä–¥ –ö–æ—Ä—è–∫–æ–≤ –∂—ë—Å—Ç–∫–æ –∏–∑–Ω–∞—Å–∏–ª–æ–≤–∞–ª –ê–Ω–≥–µ–ª–∏–Ω—É. \nhttps://vk.com/away.php?to=http%3A%2F%2Fporno365.xxx%2F&el=snippet";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'attachment' => 'photo-154749823_456239585',
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if (mb_stripos($message,"–∞–Ω–∏–º–µ") !== false) {
            $newmessage = "–î–ª—è –ø–∏–¥–æ—Ä–æ–≤";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'attachment' => "photo-154749823_456239555",
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if (mb_stripos($message,"–∏–ª—å—è –ø–∏–¥–æ—Ä") !== false) {
            $newmessage = "–ü–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –≤—Å–µ –ò–ª—å–∏ –•—Ä–∏—Å—Ç–µ–Ω–∫–∞ - –ø–∏–¥–æ—Ä—ã";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'attachment' => "photo-154749823_456239555",
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if (mb_stripos( $message,"–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ—É—Ç–±–æ–ª") !== false) {
            $newmessage = "1 –º–∞—Ç—á —Ñ—É—Ç–±–æ–ª–∞ –Ω–∞–π–¥–µ–Ω";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'attachment' => "photo-154749823_456239556",
                'access_token' => $token,
                'v' => '5.0'
            );
        }

        if (mb_stripos($message,"–º–µ–º") !== false) {
            /*  $posts = json_decode(file_get_contents('https://api.vk.com/method/wall.get?owner_id=-154749823'),true)["response"][0]["items"][0]["id"];
              $request_params = array(
                  'user_id' => $user_id,
                  'message' => $posts,
                  'access_token' => $token,
                  'v' => '5.0'
              );
              file_get_contents('https://api.vk.com/method/messages.send?' . $get_params);
              $item = $posts[array_rand($posts)];
              $photo = "photo-154749823_".$item["attachments"][0]["id"];*/
            $mems = array("photo-154749823_456239546", "photo-154749823_456239544", "photo-154749823_456239541", "photo-154749823_456239524", "photo-154749823_456239523", "photo-154749823_456239522",);
            $newmessage = "";
            $request_params = array(
                'user_id' => $user_id,
                'attachment' => $mems[array_rand($mems)],
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if (mb_stripos( $message,"–∫–∞—Ä—Ç–∏–Ω–∫–∞") !== false) {
            $mems = array("photo-154749823_456239558", "photo-154749823_456239560", "photo-154749823_456239561", "photo-154749823_456239562", "photo-154749823_456239563", "photo-154749823_456239564", "photo-154749823_456239565", "photo-154749823_456239566", "photo-154749823_456239567", "photo-154749823_456239570","photo-154749823_456239595","photo-154749823_456239596","photo-154749823_456239597","photo-154749823_456239599","photo-154749823_456239600","photo-154749823_456239603","photo-154749823_456239604");
            $newmessage = "";
            $request_params = array(
                'user_id' => $user_id,
                'attachment' => $mems[array_rand($mems)],
                'access_token' => $token,
                'v' => '5.0'
            );
        }

        if (mb_stripos( $message,"—Ö–µ–Ω—Ç–∞–π") !== false) {
            $newmessage = "–ó–∞–ø–æ–º–Ω–∏,–∞–Ω–∏–º–µ –¥–ª—è –ø–∏–¥–æ—Ä–æ–≤,–Ω–æ –≤—Å–µ-—Ç–∞–∫–∏ –¥–∞–º —Ç–µ–±–µ —Å—Å—ã–ª–∫—É –Ω–∞ —ç—Ç—É —Ö—É–π–Ω—é\nhttps://vk.com/away.php?to=http%3A%2F%2Fanimemovie.ru%2Fhentai%2F&el=snippet\nhttps://www.24video.top/tag/view/280121";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }

        if (mb_stripos( $message,"–¥–∞–Ω–∏–ª") !== false) {
            $newmessage = "–Ω–∞–π–¥–µ–Ω –î–∞–Ω–Ω–∏–ª –Ω–∞ —ç—Ç–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–µ";
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'attachment' => "photo-154749823_456239555",
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if (mb_stripos( $message,"–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É") !== false) {
            $dir = __DIR__ . "/subscribers.txt";
            if (mb_stripos(file_get_contents($dir), "$user_id") !== false) {
                $newmessage = "–í—ã —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É,—Å–æ—Ä—Ä–µ.";
                $request_params = array(
                    'message' => $newmessage,
                    'user_id' => $user_id,
                    'access_token' => $token,
                    'v' => '5.0'
                );
            } else {
                $newmessage = "–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É.–°–ø–∞—Å–∏–±–æ!";
                $request_params = array(
                    'message' => $newmessage,
                    'user_id' => $user_id,
                    'access_token' => $token,
                    'attachment' => 'photo-154749823_456239593',
                    'v' => '5.0'
                );
                file_put_contents($dir, file_get_contents($dir) . "$user_id,");
            }
        }
        if (mb_stripos( $message,"–±–æ—Ç –ø–∏–¥–æ—Ä") !== false) {
            $request_params = array(
                'message' => "–Ø –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–µ–∫—Ç.–ò —É –º–µ–Ω—è –Ω–µ—Ç –ø–æ–ª–∞. –ê –∫—Ç–æ –æ–±–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ—Ç —Ç–∞–∫ —Å–∞–º –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è. :D",
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if(mb_stripos($message,"–∏–¥–∏ –Ω–∞—Ö—É–π –±–æ—Ç") !== false){
            $request_params = array(
                'message' => "–ù–µ –º–æ–≥—É –ø–æ–π—Ç–∏ –Ω–∞ —Ç–æ —á–µ–≥–æ —É —Ç–µ–±—è –Ω–µ—Ç.",
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if(mb_stripos($message,"–∫–ª–∞—Å—Å–Ω—ã–π –±–æ—Ç") !== false){
            $request_params = array(
                'message' => "–°–ø–∞—Å–∏–±–æ.–¢—ã —Ç–æ–∂–µ",
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if(mb_stripos($message,"–º–∞—Ç—å –µ–±–∞–ª") !== false){
            $request_params = array(
                'message' => "–ü–µ—Ä–µ–¥–∞–º –∞–¥–º–∏–Ω–∞–º.–¢–≤–æ—è –º–∞—Ç—å —É–∂–µ –Ω–∞ —Å—Ç–æ–ª–µ.",
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if(mb_stripos($message,"–æ –±–æ—Ç–µ") !== false){
            $request_params = array(
                'message' => "–í—Å–µ –ø—Ä–∞–≤–∞ –Ω–∞ –±–æ—Ç–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç [id190846469|Newmcpe] –∏ [id455064951|MrKarasik]",
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if(mb_stripos($message,"–¥–ª—è –≤–∞–∂–Ω—ã—Ö –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤") !== false){
            $mems = array("photo-154749823_456239618","photo-154749823_456239617","photo-154749823_456239616","photo-154749823_456239615","photo-154749823_456239614","photo-154749823_456239613","photo-154749823_456239612","photo-154749823_456239611","photo-154749823_456239610","photo-154749823_456239609","photo-154749823_456239608","photo-154749823_456239607","photo-154749823_456239606","photo-154749823_456239605");
            $request_params = array(
                'attachment' => $mems[array_rand($mems)],
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if(mb_stripos($message,"—Å—É–∫–∞") !== false) {
            $request_params = array(
                'message' => "–°—É–∫–∞ —Ç–≤–æ—è –º–∞—Ç—å.",
                'user_id' => $user_id,
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        if (mb_stripos( $message,"–∞–ª–∏—Å–∞, –∏–∑–º–µ—Ä—å –ø–∏—Å–æ") !== false) {
            $newmessage = "–ê–ª–∏—Å–∞ –∏–∑–º–µ—Ä–∏–ª–∞ —Ç–≤–æ–π –ø–∏—Å–æ—Å";
            $alica = array("photo-154749823_456239628", "photo-154749823_456239629", "photo-154749823_456239630");
            $request_params = array(
                'message' => $newmessage,
                'user_id' => $user_id,
                'attachment' => $alica [array_rand($alica)],
                'access_token' => $token,
                'v' => '5.0'
            );
        }
        $get_params = http_build_query($request_params);
        file_get_contents('https://api.vk.com/method/messages.send?' . $get_params);
        echo('ok');
        break;
    default:
        echo('ok');
        break;
}
?>